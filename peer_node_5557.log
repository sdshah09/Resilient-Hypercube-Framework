[2024-11-28 12:37:12] Peer node 010 started on localhost:5557
[2024-11-28 12:37:17] Received message from ('::1', 65016, 0, 0): {"command": "route", "target_node_id": "010", "original_request": {"command": "add_offline_node", "failed_node": "100"}}
[2024-11-28 12:37:17] Added Failed node to offline nodes set : 100, {'100'}
[2024-11-28 12:37:17] Received message from ('::1', 65017, 0, 0): {"command": "route", "target_node_id": "011", "original_request": {"command": "add_offline_node", "failed_node": "100"}}
[2024-11-28 12:37:19] Received message from ('::1', 65029, 0, 0): {"command": "route", "target_node_id": "010", "original_request": {"command": "add_offline_node", "failed_node": "111"}}
[2024-11-28 12:37:19] Added Failed node to offline nodes set : 111, {'100', '111'}
[2024-11-28 12:37:20] Added Failed node to offline nodes set : 110, {'110', '100', '111'}
[2024-11-28 12:37:20] Node 110 went offline going into handle failure node
[2024-11-28 12:37:20] Handling failure of node: 110
[2024-11-28 12:37:20] Error in heartbeat function: [WinError 1225] The remote computer refused the network connection
[2024-11-28 12:37:21] Received message from ('::1', 65041, 0, 0): {"command": "route", "target_node_id": "010", "original_request": {"command": "remove_offline_node", "online_node": "100"}}
[2024-11-28 12:37:21] Removed node: 100 from offiline nodes set because it came online {'110', '111'}
[2024-11-28 12:37:21] Received message from ('::1', 65042, 0, 0): {"command": "route", "target_node_id": "011", "original_request": {"command": "remove_offline_node", "online_node": "100"}}
[2024-11-28 12:37:25] Removed node: 110 from offiline nodes set because it came online {'111'}
[2024-11-28 12:37:29] Node 110 that went offline came back online
[2024-11-28 12:37:30] Received message from ('::1', 65126, 0, 0): {"command": "route", "target_node_id": "010", "original_request": {"command": "remove_offline_node", "online_node": "011"}}
[2024-11-28 12:37:30] Removed node: 011 from offiline nodes set because it came online {'111'}
[2024-11-28 12:37:31] Received message from ('::1', 65144, 0, 0): {"command": "route", "target_node_id": "010", "original_request": {"command": "remove_offline_node", "online_node": "111"}}
[2024-11-28 12:37:31] Removed node: 111 from offiline nodes set because it came online set()
[2024-11-28 12:37:33] Received message from ('::1', 65163, 0, 0): {"command": "route", "target_node_id": "010", "original_request": {"command": "replicate_topic", "topic": "sports", "primary_node_id": "110", "neighbors": ["111", "100", "010"]}}
[2024-11-28 12:37:33] Replicated topic 'sports' on node 010
[2024-11-28 12:37:33] Received message from ('::1', 65165, 0, 0): {"command": "subscribe", "topic": "sports"}
[2024-11-28 12:37:33] Primary for topic 'sports' found locally: 110
[2024-11-28 12:37:33] Topic node in susbcribe function is: 110
[2024-11-28 12:37:33] Received message from ('::1', 65167, 0, 0): {"command": "find_primary", "topic": "sports"}
[2024-11-28 12:37:33] Received message from ('::1', 65180, 0, 0): {"command": "route", "target_node_id": "010", "original_request": {"command": "replicate_subscriber", "topic": "sports", "subscriber_host": "localhost", "subscriber_port": 5557, "subscriber_node_id": "010"}}
[2024-11-28 12:37:33] Replicated subscriber to topic: sports and the table is {'sports': {('localhost', 5557, '010')}}
[2024-11-28 12:37:33] Received message from ('::1', 65183, 0, 0): {"command": "find_primary", "topic": "sports", "ttl": 4}
[2024-11-28 12:37:33] Primary for topic 'sports' found locally: 110
[2024-11-28 12:37:33] Received message from ('::1', 65185, 0, 0): {"command": "route", "target_node_id": "010", "original_request": {"command": "replicate_subscriber", "topic": "sports", "subscriber_host": "localhost", "subscriber_port": 5558, "subscriber_node_id": "011"}}
[2024-11-28 12:37:33] Replicated subscriber to topic: sports and the table is {'sports': {('localhost', 5557, '010'), ('localhost', 5558, '011')}}
[2024-11-28 12:37:33] Received message from ('::1', 65191, 0, 0): {"command": "find_primary", "topic": "sports"}
[2024-11-28 12:37:33] Received message from ('::1', 65196, 0, 0): {"command": "route", "target_node_id": "010", "original_request": {"command": "replicate_subscriber", "topic": "sports", "subscriber_host": "localhost", "subscriber_port": 5556, "subscriber_node_id": "001"}}
[2024-11-28 12:37:33] Replicated subscriber to topic: sports and the table is {'sports': {('localhost', 5556, '001'), ('localhost', 5557, '010'), ('localhost', 5558, '011')}}
[2024-11-28 12:37:33] Received message from ('::1', 65205, 0, 0): {"command": "find_primary", "topic": "sports", "ttl": 4}
[2024-11-28 12:37:35] Received message from ('::1', 65235, 0, 0): {"command": "find_primary", "topic": "sports"}
[2024-11-28 12:37:35] Received message from ('::1', 65240, 0, 0): {"command": "receive_message", "topic": "sports", "message": "Team A won!"}
[2024-11-28 12:37:35] Received message on topic 'sports': Team A won!
[2024-11-28 12:37:36] Received message from ('::1', 65251, 0, 0): {"command": "find_primary", "topic": "sports"}
[2024-11-28 12:37:36] Received message from ('::1', 65256, 0, 0): {"command": "receive_message", "topic": "sports", "message": "Game scheduled for tomorrow."}
[2024-11-28 12:37:36] Received message on topic 'sports': Game scheduled for tomorrow.
[2024-11-28 12:37:37] Primary for topic 'sports' found locally: 110
[2024-11-28 12:37:37] Received message from ('::1', 65262, 0, 0): {"command": "find_primary", "topic": "sports"}
[2024-11-28 12:37:37] Received message from ('::1', 65281, 0, 0): {"command": "find_primary", "topic": "sports"}
[2024-11-28 12:37:37] Received message from ('::1', 65282, 0, 0): {"command": "find_primary", "topic": "sports", "ttl": 4}
[2024-11-28 12:37:37] Received message from ('::1', 65293, 0, 0): {"command": "receive_message", "topic": "sports", "message": "Exciting match ahead!"}
[2024-11-28 12:37:37] Received message on topic 'sports': Exciting match ahead!
[2024-11-28 12:37:38] Received message from ('::1', 65307, 0, 0): {"command": "add_offline_node", "failed_node": "000"}
[2024-11-28 12:37:38] Added Failed node to offline nodes set : 000, {'000'}
[2024-11-28 12:37:38] Received message from ('::1', 65311, 0, 0): {"command": "route", "target_node_id": "010", "original_request": {"command": "remove_offline_node", "online_node": "000"}}
[2024-11-28 12:37:38] Removed node: 000 from offiline nodes set because it came online set()
[2024-11-28 12:37:41] Primary for topic 'sports' found locally: 110
[2024-11-28 12:37:41] Received message from ('::1', 65332, 0, 0): {"command": "find_primary", "topic": "sports"}
[2024-11-28 12:37:41] Received message from ('::1', 65346, 0, 0): {"command": "find_primary", "topic": "sports", "ttl": 4}
[2024-11-28 12:37:43] Received message from ('::1', 65372, 0, 0): {"command": "find_primary", "topic": "sports"}
[2024-11-28 12:37:43] Received message from ('::1', 65377, 0, 0): {"command": "receive_message", "topic": "sports", "message": "New primary works!"}
[2024-11-28 12:37:43] Received message on topic 'sports': New primary works!
[2024-11-28 12:37:44] Received message from ('::1', 65388, 0, 0): {"command": "find_primary", "topic": "sports"}
[2024-11-28 12:37:44] Received message from ('::1', 65393, 0, 0): {"command": "receive_message", "topic": "sports", "message": "Match postponed."}
[2024-11-28 12:37:44] Received message on topic 'sports': Match postponed.
[2024-11-28 12:37:45] Primary for topic 'sports' found locally: 110
[2024-11-28 12:37:45] Received message from ('::1', 65402, 0, 0): {"command": "find_primary", "topic": "sports"}
[2024-11-28 12:37:45] Received message from ('::1', 65414, 0, 0): {"command": "find_primary", "topic": "sports", "ttl": 4}
[2024-11-28 12:37:49] Primary for topic 'sports' found locally: 110
[2024-11-28 12:37:49] Received message from ('::1', 65446, 0, 0): {"command": "find_primary", "topic": "sports"}
[2024-11-28 12:37:49] Received message from ('::1', 65456, 0, 0): {"command": "find_primary", "topic": "sports", "ttl": 4}
[2024-11-28 12:37:50] Received message from ('::1', 65479, 0, 0): {"command": "find_primary", "topic": "sports"}
[2024-11-28 12:43:38] Failed to route message to 000: [WinError 1225] The remote computer refused the network connection
[2024-11-28 12:43:42] Failed to route message to 000: [WinError 1225] The remote computer refused the network connection
[2024-11-28 12:43:42] Added Failed node to offline nodes set : 000, {'000'}
[2024-11-28 12:43:42] Node 000 went offline going into handle failure node
[2024-11-28 12:43:42] Handling failure of node: 000
[2024-11-28 12:43:45] Received message from ('::1', 3189, 0, 0): {"command": "route", "target_node_id": "010", "original_request": {"command": "add_offline_node", "failed_node": "001"}}
[2024-11-28 12:43:45] Added Failed node to offline nodes set : 001, {'001', '000'}
[2024-11-28 12:45:28] Peer node 010 shut down.
